import os

SUSPICIOUS_KEYWORDS = [
    "rat", "spy", "keylog", "stealer",
    "hack", "mod", "crack", "inject",
    "trojan", "payload", "backdoor"
]

SUSPICIOUS_EXTENSIONS = (
    ".apk", ".dex", ".sh", ".bin"
)

SCAN_PATHS = [
    "/storage/emulated/0/Download",
    "/storage/emulated/0/Android/data",
    "/storage/emulated/0/"
]

def malware_scan():
    threats = []

    for base in SCAN_PATHS:
        if not os.path.exists(base):
            continue

        for root, dirs, files in os.walk(base):
            for file in files:
                filename = file.lower()
                full_path = os.path.join(root, file)

                # Keyword detection
                if any(k in filename for k in SUSPICIOUS_KEYWORDS):
                    threats.append(full_path)
                    continue

                # Hidden APKs
                if filename.startswith(".") and filename.endswith(".apk"):
                    threats.append(full_path)
                    continue

                # Dangerous extensions
                if filename.endswith(SUSPICIOUS_EXTENSIONS):
                    try:
                        size = os.path.getsize(full_path)
                        if size > 5 * 1024 * 1024:  # >5MB
                            threats.append(full_path)
                    except:
                        pass

    return list(set(threats))
